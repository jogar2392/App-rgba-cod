<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Selector de Colores</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#007BFF">
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
    background: #f0f0f0;
  }
  h1 {
    margin-bottom: 20px;
  }
  .preview {
    width: 200px;
    height: 200px;
    margin: 20px auto;
    border-radius: 10px;
    border: 2px solid #000;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    background-image: 
      linear-gradient(45deg, #ccc 25%, transparent 25%),
      linear-gradient(-45deg, #ccc 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, #ccc 75%),
      linear-gradient(-45deg, transparent 75%, #ccc 75%);
    background-size: 20px 20px;
    background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
  }
  input[type=range] {
    width: 300px;
    height: 15px;
    border-radius: 5px;
    appearance: none;
    outline: none;
  }
  #hue {
    background: linear-gradient(to right, 
      red 0%, yellow 17%, lime 33%, cyan 50%, blue 67%, magenta 83%, red 100%);
  }
  #saturation {
    background: linear-gradient(to right, gray, currentColor);
  }
  .codes {
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    align-items: center;
  }
  .code-box {
    display: flex;
    align-items: center;
    gap: 5px;
  }
  input.color-code {
    font-family: monospace;
    padding: 6px;
    border: 1px solid #aaa;
    border-radius: 6px;
    width: 240px;
    text-align: center;
    background: #fff;
  }
  button {
    padding: 6px 12px;
    border: none;
    border-radius: 6px;
    background: #007BFF;
    color: white;
    cursor: pointer;
  }
  .favoritos {
    margin-top: 30px;
  }
  .paleta {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
  }
  .color-item {
    width: 60px;
    height: 60px;
    border-radius: 6px;
    border: 2px solid #000;
    cursor: pointer;
    position: relative;
  }
  .color-item span {
    position: absolute;
    bottom: 2px;
    left: 2px;
    right: 2px;
    font-size: 10px;
    color: #fff;
    background: rgba(0,0,0,0.5);
    border-radius: 3px;
    padding: 1px;
    text-align: center;
  }
</style>
</head>
<body>

<h1>Selector de Espectro + Intensidad</h1>

<div class="preview" id="preview"></div>

<div>
  <label>Tono: <span id="hueVal">240</span></label><br>
  <input type="range" id="hue" min="0" max="360" value="240">
</div>

<div>
  <label>Intensidad: <span id="satVal">100</span></label><br>
  <input type="range" id="saturation" min="0" max="100" value="100">
</div>

<div>
  <label>Transparencia: <span id="alphaVal">100</span></label><br>
  <input type="range" id="alpha" min="0" max="100" value="100">
</div>

<div class="codes">
  <div class="code-box">
    <input id="hslaBox" class="color-code" readonly>
    <button onclick="copiar('hslaBox')">Copiar</button>
  </div>
  <div class="code-box">
    <input id="rgbaBox" class="color-code" readonly>
    <button onclick="copiar('rgbaBox')">Copiar</button>
  </div>
  <div class="code-box">
    <input id="hexBox" class="color-code" readonly>
    <button onclick="copiar('hexBox')">Copiar</button>
  </div>
</div>

<button onclick="guardarFavorito()">‚≠ê Guardar Favorito</button>

<div class="favoritos">
  <h2>Mis Colores Favoritos</h2>
  <div class="paleta" id="paleta"></div>
</div>

<script>
const preview = document.getElementById("preview");
const hue = document.getElementById("hue");
const saturation = document.getElementById("saturation");
const alpha = document.getElementById("alpha");

const hslaBox = document.getElementById("hslaBox");
const rgbaBox = document.getElementById("rgbaBox");
const hexBox = document.getElementById("hexBox");

let coloresFavoritos = JSON.parse(localStorage.getItem("favoritos")) || [];

function updateColor() {
  const h = hue.value;
  const s = saturation.value;
  const l = 50;   
  const a = alpha.value / 100; 

  document.getElementById("hueVal").textContent = h;
  document.getElementById("satVal").textContent = s;
  document.getElementById("alphaVal").textContent = alpha.value;

  const hsla = `hsla(${h}, ${s}%, ${l}%, ${a})`;

  function hslToRgb(h, s, l) {
    s /= 100;
    l /= 100;
    const k = n => (n + h/30) % 12;
    const a = s * Math.min(l, 1 - l);
    const f = n => l - a * Math.max(-1, Math.min(k(n)-3, Math.min(9-k(n), 1)));
    return [Math.round(255*f(0)), Math.round(255*f(8)), Math.round(255*f(4))];
  }
  const [r, g, b] = hslToRgb(h, s, l);
  const rgba = `rgba(${r}, ${g}, ${b}, ${a})`;

  const toHex = x => x.toString(16).padStart(2, "0");
  const hex = `#${toHex(r)}${toHex(g)}${toHex(b)}${toHex(Math.round(a*255))}`;

  preview.style.backgroundColor = hsla;

  hslaBox.value = hsla;
  rgbaBox.value = rgba;
  hexBox.value = hex;

  const pureColor = `hsl(${h},100%,50%)`;
  saturation.style.background = `linear-gradient(to right, gray, ${pureColor})`;
}

function copiar(id) {
  const input = document.getElementById(id);
  navigator.clipboard.writeText(input.value).then(() => {
    alert("Copiado: " + input.value);
  });
}

function guardarFavorito() {
  const color = {
    hsla: hslaBox.value,
    rgba: rgbaBox.value,
    hex: hexBox.value
  };
  coloresFavoritos.push(color);
  localStorage.setItem("favoritos", JSON.stringify(coloresFavoritos));
  mostrarFavoritos();
}

function mostrarFavoritos() {
  const paleta = document.getElementById("paleta");
  paleta.innerHTML = "";
  coloresFavoritos.forEach((c, i) => {
    const div = document.createElement("div");
    div.className = "color-item";
    div.style.background = c.hsla;
    div.innerHTML = `<span>${i+1}</span>`;
    div.onclick = () => {
      hslaBox.value = c.hsla;
      rgbaBox.value = c.rgba;
      hexBox.value = c.hex;
      preview.style.background = c.hsla;
    };
    paleta.appendChild(div);
  });
}

[hue, saturation, alpha].forEach(input => input.addEventListener("input", updateColor));

updateColor();
mostrarFavoritos();

if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js")
    .then(() => console.log("SW registrado"))
    .catch(err => console.error("Error SW:", err));
}
</script>

</body>
</html>